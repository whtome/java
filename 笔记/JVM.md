JDK：Java开发工具

JRE：Java运行环境

JVM：Java虚拟机（对应平台的虚拟机，不跨平台）



从JDK1.3至今，HotSpot为默认JVM



JVM内存区域划分 -> 判断对象是否存活 -> 垃圾回收算法 -> 垃圾回收器 -> JVM性能检测



三      Java内存区域划分  --  共六块内存



3.1 线程私有内存：每个线程都有，彼此之间完全隔离

3.1.1   程序计数器 

   程序计数器是比较小的内存空间，当前线程所执行的字节码的行号指示器。

   若当前线程执行的是Java方法，计数器记录的是正在执行的JVM字节毛指令地址；

   若当前线程执行的是Native方法，计数器值为空。

   程序计数器是唯一一块不会产生OOM异常的区域。



3.1.2   虚拟机栈--java方法执行的内存模型

虚拟机栈描述Java方法的内存模型。

每个方法执行的同时都会创建一个栈帧存储局部变量表，操作数栈，方法出口等信息。每个方法从调用直到执行完毕的过程，对应一个栈帧在虚拟机栈的入栈与出栈过程。

生命周期与线程相同：在创建线程的同时创建此线程的虚拟机栈，线程执行结束，虚拟机栈与线程一同被回收。

局部变量表：存放编译器可知的的各种基本数据类型（8大基本数据类型），对象引用。

此区域一共会产生两种异常：

a . 若线程请求的栈深度大于JVM允许的深度（-Xss设置栈容量），抛出StackOverFlowError异常.(单线程)

b . 虚拟机在进行栈的动态扩展时，若无法申请到足够内存，抛出OOM（OutOfMemoryError）异常。（多线程）



3.1.3  本地方法栈

本地方法（native方法）执行的内存模型，其他与虚拟机栈完全相同。

HotSpot虚拟机中，本地方法栈与虚拟机栈是同一块内存区域。



3.2 线程共享内存：所有线程共享此内存空间，此空间对所有线程可见。

3.1.4   堆（GC堆）

   Java堆（Java  Heap）是JVM管理的最大内存区域。在JVM启动是创建，所有线程共享此内存，此内存中存放的都是对象实例及数组。

Java堆是垃圾回收器管理的最主要内存区域。Java堆可以处于物理上不连续的内存空间。-Xmx设置堆最大值 ， -Xms设置堆最小值

若在堆中没有足够的内存完成对象实例分配并且堆无法再次扩展时。抛出OOM异常。

OOM：

内存溢出：内存中的对象确实还应该存活，但由于堆内存不够用产生的异常。

内存泄露：无用对象无法被GC



3.1.5   方法区

用于存储已被JVM加载的类信息，常量，静态变量等数据。JDK8以前，方法区也叫”永久代“，JDK8之后称为元空间（Meta Space）

方法区无法满足内存分配需求时，抛出OOM



3.1.6 运行时常量池

运行时常量池是方法区的一部分，存放字面量与符号引用。

字面量：字符串常量（JDK1.7移到堆中），final常量，基本数据类型的值。

符号引用：类，字段，方法的完全限定名，名称，描述符。